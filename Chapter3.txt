Lab 3-1:

1. The malware only has ExitProcess as an import. Definitely packed, Lab03-01.exe is just a wrapper. 

Strings:
!This program cannot be run in DOS mode.
ExitProcess
kernel32.dll
CONNECT %s:%i HTTP/1.0
advapi32
ntdll
user32
StubPath
SOFTWARE\Classes\htpp\shell\open\commandV
Software\Microsoft\Active Setup\Installed Components\
test
 www.practicalmalwareanalysis.com
admin
VideoDriver
vmx32to64.exe
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
AppData

-----

2. Comparing the Regshot snapshots before and after execution, 3 keys and 48 values have been added. 9 values have been modified, but 2 of those are RNG seeds and can definitely be discounted since they change constantly anyway.

The first value added is:
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VideoDriver: ...[string of hex here]...

This means Lab03-01.exe set the key 'VideoDriver' to run every time the user logs on.

Procmon shows a large number of processes. Three types of registry-related functions are being called - RegOpenKey, RegQueryValue, RegCloseKey - but the only registry values being set are RNG seeds and the VideoDriver value listed above. The only WriteFile process called writes vmx32to64.exe immediately before this registry value change.

Looking at this location, vmx32to64.exe has indeed been written to the system32 folder. So Lab03-01.exe has installed an executable is set to run at system startup.

-----

3. Wireshark has picked up several packets which seem to be anywhere between 120 and 500 seconds apart. There are two repeating announcements being broadcast: Domain/Workgroup and Local Master. These are consistently 258 and 250 bytes in length respectively.

No Netcat output on port 80.

Netcat output over port 443 is inconsistent garbage. No apparent signals or custom protocols here.

____________

Lab 3-2:

1. Looking through Lab03-02.dll's strings, this DLL uses the Install function. Running [rundll32.exe Lab03-02.dll, Install] or [rundll32.exe Lab03-02.dll, installA] might install it.

Windows functions are usually capitalised - installA is not. I ran this one first because it seemed the most suspect for that reason. Registry values have been altered by services.exe and rundll32.exe to point to Lab03-02.dll as a result, so it has installed itself.

2. The DLL has installed a service called IPRIP, which can be launched using [net start IPRIP].

3. Lab03-02.dll is listed under svchost.exe's DLLs in Process Explorer, so it's running as part of this process (specifically svchost.exe with PID 1044).

4. Filtering to include only process name svchost.exe gives just over 50,000 events. 

5. See above answers.

6. HTTP appears in strings, so netcat was set to listen on port 80. The following signature appeared after a long wait:

GET /serve.html HTTP:/1.1
Accept: */*
User-Agent: victim1-a020d27 Windows XP 6.11
Host: practicalmalwareanalysis.com

This consistently appears every time the malware is run. Everything except the machine name should be consistent across all infected machines (assuming the host URL doesn't change), so this can be used as a signature to identify Lab03-02.dll.

____________

Lab 3-3:

1. 